doctype html
html(lang="en")
  head
    title Yehaa Playlist Viewer
    link(href='/css/yehaa.css', rel='stylesheet')
    script(src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js")
    script(type='text/javascript').
      // After the API loads, call a function to enable the search box.
      var playlists = !{JSON.stringify(playlists)}
      function handleAPILoaded() {
        //$('#search-button').attr('disabled', false);
      }
      function search(){
         var q = playlists[$('#pl-select').val()];
         $("#loader").css('visibility', 'visible');
         $.ajax({
            url: 'fpl',
            data: {'p': q},
            dataType: 'html',
            error: fetchError,
            success: fetchSuccess
         });
      }
      function fetchError(error, status, eThrown){
        $("#loader").css('visibility', 'hidden');
        console.log(error);
      }
      function fetchSuccess(data){
        $("#result-list").empty().html(data);
        $("#loader").css('visibility', 'hidden');
      }
  body
    header
      h2 Yehaa Playlist Viewer
    center
      .select-artist Select an artist from the dropdown below
      select#pl-select(onchange="search()")
        each playlist, index in playlists
          option(value=index)= playlist
      img#loader(src="/img/ajax-loader.gif", style="visibility: hidden;")
    #search-container
      ul#result-list
        include playlist.jade